import{c as D,r as _,o as R,a as c,e as i,f as e,g as U,h as I,t as l,y as r,j as m,B as $,F as y,l as b,w as S,m as z,n as A,C as K,b as O,d as n,i as j,x as q,v as G,p as J,k as Q,z as W,u as X}from"./index-BVPeGx3u.js";import{l as Z,s as ee}from"./like-Cq13m2ZL.js";import{h as x}from"./moment-C5S46NFB.js";import{S as u}from"./sweetalert2.esm.all-Br4OTrmy.js";import{P as se,N as te,S as oe,a as ae}from"./pagination-5KVE1or3.js";import{l as le}from"./likeed-BS52KISc.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie="/assets/404img-CbatP5_C.avif",ce=p=>(J("data-v-0e3204e1"),p=p(),Q(),p),re={key:0,class:"discription"},ue={class:"feedinfobox"},de=["src"],_e={class:"commentdetail"},me={class:"username"},pe={class:"sub"},ve={class:"uploadtime"},he={class:"userbutton"},fe={key:0,class:"Ownerbox"},Ce={key:1,class:"Audiencebox"},ge={class:"slidewrap"},ke={class:"slidewrap"},we=["src","data-fallback"],De={class:"interact"},Ie={class:"caption"},ye={class:"place"},be={class:"makerdrop"},xe={class:"LCS"},Be={class:"LC"},Pe=["src"],Fe=ce(()=>e("span",null,[e("img",{src:ee,alt:"",class:"save"})],-1)),Ue=["src"],Se={class:"commentdetail"},Te={class:"username"},Ye={class:"content"},Le={class:"sub"},Me={class:"uploadtime"},He=["onClick"],Ne={class:"commentcontainer"},Ve={__name:"FeedDetail",setup(p){const B=K(),P=W(),v=X();D(()=>v.state.isModify);const C=D(()=>v.state.User_ID),t=_(null);_(null);const h=D(()=>t.value&&C.value===t.value.post.User_ID),T=()=>{P.push({name:"modify"})},Y=()=>{v.commit("Switch_isMsg")},L=()=>{t.value.isFollowedByCurrentUser&&u.fire({title:"정말 팔로우를 취소하시겠습니까?",text:" ",icon:"warning",showCancelButton:!0,confirmButtonText:"팔로우 취소",cancelButtonText:"취소"}).then(async s=>{s.isConfirmed&&await c.post("/user/unfollow",{userId:t.value.post.User_ID},{withCredentials:!0}).then(o=>{console.log(o.data),u.fire("팔로우 취소","팔로우가 취소되었습니다.","success"),v.commit("Update_Follow_Status",!1)}).catch(o=>{console.log(o)})})},M=async()=>{u.fire({title:"정말로 게시글을 삭제하시겠습니까?",text:"삭제된 게시글은 되돌릴 수 없습니다.",icon:"warning",showCancelButton:!0,confirmButtonText:"삭제",cancelButtonText:"취소"}).then(async s=>{s.isConfirmed?await c.post("/feeds/Post_delete",{postId:t.value.post.Post_ID},{withCredentials:!0}).then(o=>{console.log(o.data),u.fire("게시글이 삭제되었습니다!","홈화면으로 이동합니다.","success"),P.push({name:"HomeFeed"})}).catch(o=>{console.log(o)}):s.dismiss===u.DismissReason.cancel&&u.fire("게시글 삭제가 취소되었습니다.","ㅋㅋ봐줌","error")})},f=_(""),g=_([]),k=()=>{c.post("/feeds/Comment/list",{Post_ID:t.value.post.Post_ID},{withCredentials:!0}).then(s=>{g.value=s.data,console.log(s.data)}).catch(s=>{console.log("오류발생"),console.log(s)})},F=()=>{x().format("YYYY년 MM월 DD일 HH:mm"),c.post("/feeds/Comment/add",{Post_ID:t.value.post.Post_ID,Comment:f.value},{withCredentials:!0}).then(s=>{console.log(s.data),k()}).catch(s=>{console.log("오류발생"),console.log(s)}),f.value=""},H=s=>{s.User_ID===C.value&&u.fire({title:"정말 코멘트를 지우겠습니까?",text:" ",icon:"warning",showCancelButton:!0,confirmButtonText:"코멘트 삭제",cancelButtonText:"취소"}).then(async o=>{o.isConfirmed&&c.post("/feeds/Comment/delete",{Post_ID:t.value.post.Post_ID,Comment_ID:s.Comment_ID},{withCredentials:!0}).then(d=>{console.log(d.data),k()}).catch(d=>{console.log("오류발생"),console.log(d)})})};_(null),R(()=>{console.log("테스트1"),console.log(B.params.Post_ID),c.get("/Feeds/Post_detail/"+B.params.Post_ID,{withCredentials:!0}).then(s=>{console.log(s.data),t.value=s.data,k()}).catch(s=>{console.log("오류발생"),console.log(s)})});const N=s=>{s.isLike?c.post("/feeds/Like/remove",{postId:s.Post_ID},{withCredentials:!0}).then(o=>{s.isLike=!s.isLike}).catch(o=>{o.response.status==400}):c.post("/feeds/Like/add",{postId:s.Post_ID},{withCredentials:!0}).then(o=>{s.isLike=!s.isLike}).catch(o=>{o.response.status==400})},V=s=>{s.target.src=s.target.getAttribute("data-fallback")},E=[se,te];return(s,o)=>{const d=O("router-link");return t.value?(n(),i("div",re,[e("div",ue,[e("span",null,[e("img",{src:t.value.post.Profile_Img,alt:"",class:"profile"},null,8,de)]),e("div",_e,[e("div",null,[e("span",me,[U(d,{to:{name:"PersonalPage",params:{User_ID:t.value.post.User_ID}},class:"userID"},{default:I(()=>[j(l(t.value.post.User_ID),1)]),_:1},8,["to"])])]),e("div",pe,[e("span",ve,l(r(x)(t.value.post.Post_Create_Timestamp).format("YYYY년 MM월 DD일 HH:mm")),1)])]),e("div",he,[h.value?(n(),i("div",fe,[e("button",{onClick:o[0]||(o[0]=a=>T()),class:"modifybutton"}," 수정 "),e("button",{class:"feeddelete",onClick:M},"삭제")])):m("",!0),h.value?m("",!0):(n(),i("div",Ce)),h.value?m("",!0):(n(),i("button",{key:2,class:"follow",onClick:L,style:$({backgroundColor:t.value.isFollowedByCurrentUser?"#EFEFEF":"black",borderColor:t.value.isFollowedByCurrentUser?"#F2F2F2":"black",color:t.value.isFollowedByCurrentUser?"black":"white"})},l(t.value.isFollowedByCurrentUser?"팔로잉":"팔로우"),5)),h.value?m("",!0):(n(),i("button",{key:3,class:"message",onClick:Y}," 메시지 "))])]),e("div",ge,[e("div",ke,[U(r(ae),{spaceBetween:1,slidesPerView:1,pagination:!0,navigation:!0,modules:E,class:"mySwiper"},{default:I(()=>[(n(!0),i(y,null,b(t.value.post.Image_Srcs,(a,w)=>(n(),q(r(oe),{key:w},{default:I(()=>[e("img",{src:a,onError:V,"data-fallback":r(ie),alt:"Image preview"},null,40,we)]),_:2},1024))),128))]),_:1})]),e("div",null,[e("div",De,[e("div",null,l(t.value.post.Post_Title),1),e("div",Ie,l(t.value.post.Post_Caption),1)])])]),e("ul",ye,[(n(!0),i(y,null,b(t.value.tags,a=>(n(),i("li",{key:a,class:"tag"},"#"+l(a),1))),128))]),e("ul",be,[e("li",xe,[e("span",Be,"좋아요 "+l(t.value.post.likeCount)+" 댓글 "+l(g.value.length),1),e("span",null,[e("img",{src:t.value.post.isLike?r(le):r(Z),alt:"",class:"like",onClick:o[1]||(o[1]=a=>N(t.value.post))},null,8,Pe)]),Fe])]),(n(!0),i(y,null,b(g.value,(a,w)=>(n(),i("div",{key:w,class:"commentbox"},[e("span",null,[e("img",{src:a.Profile_Img,alt:"",class:"profile"},null,8,Ue)]),e("div",Se,[e("div",null,[e("span",Te," @"+l(a.User_ID)+"-"+l(a.User_Name),1),e("span",Ye,l(a.Comment_Text),1)]),e("div",Le,[e("span",Me,l(r(x)(a.Comment_Timestamp).format("YYYY년MM월DD일 HH:mm:ss")),1),S(e("span",{class:"reply",onClick:Ee=>H(a)},"삭제",8,He),[[G,a.User_ID===C.value]])])])]))),128)),e("div",Ne,[S(e("input",{class:"comment",type:"text",placeholder:"댓글을 입력하세요.","onUpdate:modelValue":o[2]||(o[2]=a=>f.value=a),onKeypress:A(F,["enter"])},null,544),[[z,f.value]]),e("button",{class:"commenting",onClick:F},"입력")])])):m("",!0)}}},qe=ne(Ve,[["__scopeId","data-v-0e3204e1"]]);export{qe as default};
