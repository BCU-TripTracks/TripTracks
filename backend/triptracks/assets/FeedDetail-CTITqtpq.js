import{c as D,r as d,o as N,a as c,e as n,f as e,g as V,h as R,t as a,x as _,j as m,B as $,F as x,l as B,w as F,m as z,n as A,C as K,b as O,d as i,i as j,v as q,p as G,k as J,z as Q,u as W}from"./index-Vsuo-NJs.js";import{l as X,s as Z}from"./like-Cq13m2ZL.js";import{h as w}from"./moment-C5S46NFB.js";import{S as r}from"./sweetalert2.esm.all-Br4OTrmy.js";import{l as ee}from"./likeed-BS52KISc.js";import{i as se}from"./404img-BemuhLvh.js";/* empty css                                                                */import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U=p=>(G("data-v-031c73d0"),p=p(),J(),p),oe={key:0,class:"discription"},le={class:"feedinfobox"},ae=["src"],ne={class:"commentdetail"},ie={class:"username"},ce={class:"sub"},re={class:"uploadtime"},ue={class:"userbutton"},de={key:0,class:"Ownerbox"},_e={key:1,class:"Audiencebox"},me={class:"slidewrap"},pe=U(()=>e("ul",{class:"slidelist"},[e("li",null,[e("a",null,[e("label",{for:"slide03",class:"left"}),e("label",{for:"slide02",class:"right"})])])],-1)),he=["src","data-fallback"],ve={class:"caption mt10"},fe={class:"place"},Ce={class:"makerdrop"},ge={class:"LCS"},ke={class:"LC"},De=["src"],we=U(()=>e("span",null,[e("img",{src:Z,alt:"",class:"save"})],-1)),Ie=["src"],ye={class:"commentdetail"},be={class:"username"},xe={class:"content"},Be={class:"sub"},Fe={class:"uploadtime"},Ue=["onClick"],Pe={class:"commentcontainer"},Se={__name:"FeedDetail",setup(p){const I=K(),y=Q(),h=W();D(()=>h.state.isModify);const C=D(()=>h.state.User_ID),t=d(null);d(null);const v=D(()=>t.value&&C.value===t.value.post.User_ID),P=()=>{y.push({name:"modify"})},S=()=>{h.commit("Switch_isMsg")},T=()=>{t.value.isFollowedByCurrentUser&&r.fire({title:"정말 팔로우를 취소하시겠습니까?",text:" ",icon:"warning",showCancelButton:!0,confirmButtonText:"팔로우 취소",cancelButtonText:"취소"}).then(async s=>{s.isConfirmed&&await c.post("/user/unfollow",{userId:t.value.post.User_ID},{withCredentials:!0}).then(o=>{console.log(o.data),r.fire("팔로우 취소","팔로우가 취소되었습니다.","success"),h.commit("Update_Follow_Status",!1)}).catch(o=>{console.log(o)})})},Y=async()=>{r.fire({title:"정말로 게시글을 삭제하시겠습니까?",text:"삭제된 게시글은 되돌릴 수 없습니다.",icon:"warning",showCancelButton:!0,confirmButtonText:"삭제",cancelButtonText:"취소"}).then(async s=>{s.isConfirmed?await c.post("/feeds/Post_delete",{postId:t.value.post.Post_ID},{withCredentials:!0}).then(o=>{console.log(o.data),r.fire("게시글이 삭제되었습니다!","홈화면으로 이동합니다.","success"),y.push({name:"HomeFeed"})}).catch(o=>{console.log(o)}):s.dismiss===r.DismissReason.cancel&&r.fire("게시글 삭제가 취소되었습니다.","ㅋㅋ봐줌","error")})},f=d(""),g=d([]),k=()=>{c.post("/feeds/Comment/list",{Post_ID:t.value.post.Post_ID},{withCredentials:!0}).then(s=>{g.value=s.data,console.log(s.data)}).catch(s=>{console.log("오류발생"),console.log(s)})},b=()=>{w().format("YYYY년 MM월 DD일 HH:mm"),c.post("/feeds/Comment/add",{Post_ID:t.value.post.Post_ID,Comment:f.value},{withCredentials:!0}).then(s=>{console.log(s.data),k()}).catch(s=>{console.log("오류발생"),console.log(s)}),f.value=""},L=s=>{s.User_ID===C.value&&r.fire({title:"정말 코멘트를 지우겠습니까?",text:" ",icon:"warning",showCancelButton:!0,confirmButtonText:"코멘트 삭제",cancelButtonText:"취소"}).then(async o=>{o.isConfirmed&&c.post("/feeds/Comment/delete",{Post_ID:t.value.post.Post_ID,Comment_ID:s.Comment_ID},{withCredentials:!0}).then(u=>{console.log(u.data),k()}).catch(u=>{console.log("오류발생"),console.log(u)})})};d(null),N(()=>{console.log("테스트1"),console.log(I.params.Post_ID),c.get("/Feeds/Post_detail/"+I.params.Post_ID,{withCredentials:!0}).then(s=>{console.log(s.data),t.value=s.data,k()}).catch(s=>{console.log("오류발생"),console.log(s)})});const M=s=>{s.isLike?c.post("/feeds/Like/remove",{postId:s.Post_ID},{withCredentials:!0}).then(o=>{s.isLike=!s.isLike}).catch(o=>{o.response.status==400}):c.post("/feeds/Like/add",{postId:s.Post_ID},{withCredentials:!0}).then(o=>{s.isLike=!s.isLike}).catch(o=>{o.response.status==400})},H=s=>{s.target.src=s.target.getAttribute("data-fallback")};return(s,o)=>{const u=O("router-link");return t.value?(i(),n("div",oe,[e("div",le,[e("span",null,[e("img",{src:t.value.post.Profile_Img,alt:"",class:"profile"},null,8,ae)]),e("div",ne,[e("div",null,[e("span",ie,[V(u,{to:{name:"PersonalPage",params:{User_ID:t.value.post.User_ID}},class:"userID"},{default:R(()=>[j(a(t.value.post.User_ID),1)]),_:1},8,["to"])])]),e("div",ce,[e("span",re,a(_(w)(t.value.post.Post_Create_Timestamp).format("YYYY년 MM월 DD일 HH:mm")),1)])]),e("div",ue,[v.value?(i(),n("div",de,[e("button",{onClick:o[0]||(o[0]=l=>P()),class:"modifybutton"},"수정"),e("button",{class:"feeddelete",onClick:Y},"삭제")])):m("",!0),v.value?m("",!0):(i(),n("div",_e)),v.value?m("",!0):(i(),n("button",{key:2,class:"follow",onClick:T,style:$({backgroundColor:t.value.isFollowedByCurrentUser?"#EFEFEF":"black",borderColor:t.value.isFollowedByCurrentUser?"#F2F2F2":"black",color:t.value.isFollowedByCurrentUser?"black":"white"})},a(t.value.isFollowedByCurrentUser?"팔로잉":"팔로우"),5)),v.value?m("",!0):(i(),n("button",{key:3,class:"message",onClick:S},"메시지"))])]),e("div",me,[pe,e("img",{src:t.value.post.Image_Src,onError:H,"data-fallback":_(se),alt:""},null,40,he),e("div",null,a(t.value.post.Post_Title),1),e("div",ve,a(t.value.post.Post_Caption),1)]),e("ul",fe,[(i(!0),n(x,null,B(t.value.tags,l=>(i(),n("li",{key:l,class:"tag"},"#"+a(l),1))),128))]),e("ul",Ce,[e("li",ge,[e("span",ke,"좋아요 "+a(t.value.post.likeCount)+" 댓글 "+a(g.value.length),1),e("span",null,[e("img",{src:t.value.post.isLike?_(ee):_(X),alt:"",class:"like",onClick:o[1]||(o[1]=l=>M(t.value.post))},null,8,De)]),we])]),(i(!0),n(x,null,B(g.value,(l,E)=>(i(),n("div",{key:E,class:"commentbox"},[e("span",null,[e("img",{src:l.Profile_Img,alt:"",class:"profile"},null,8,Ie)]),e("div",ye,[e("div",null,[e("span",be," @"+a(l.User_ID)+"-"+a(l.User_Name),1),e("span",xe,a(l.Comment_Text),1)]),e("div",Be,[e("span",Fe,a(_(w)(l.Comment_Timestamp).format("YYYY년MM월DD일 HH:mm:ss")),1),F(e("span",{class:"reply",onClick:Te=>L(l)},"삭제",8,Ue),[[q,l.User_ID===C.value]])])])]))),128)),e("div",Pe,[F(e("input",{class:"comment",type:"text",placeholder:"댓글을 입력하세요.","onUpdate:modelValue":o[2]||(o[2]=l=>f.value=l),onKeypress:A(b,["enter"])},null,544),[[z,f.value]]),e("button",{class:"commenting",onClick:b},"입력")])])):m("",!0)}}},$e=te(Se,[["__scopeId","data-v-031c73d0"]]);export{$e as default};
