import{c as g,r as u,o as j,a as n,A as z,e as c,f as s,g as F,h as x,t as l,y as d,j as m,B as A,F as S,l as P,w as T,m as O,n as K,C as $,b as q,d as i,i as G,x as J,v as Q,p as W,k as X,z as Z,u as ee}from"./index-D1XIqiWT.js";import{l as se,s as te}from"./like-Cq13m2ZL.js";import{h as b}from"./moment-C5S46NFB.js";import{S as _}from"./sweetalert2.esm.all-Br4OTrmy.js";import{P as oe,N as ae,S as le,a as ne}from"./pagination-D1rNdtn1.js";import{l as ie}from"./likeed-BS52KISc.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re="/assets/404img-CbatP5_C.avif",ue=p=>(W("data-v-3427d9c6"),p=p(),X(),p),de={key:0,class:"discription"},_e={class:"feedinfobox"},me={class:"commentdetail"},pe={class:"username"},he={class:"sub"},ve={class:"uploadtime"},fe={class:"userbutton"},ge={key:0,class:"Ownerbox"},Ce={key:1,class:"Audiencebox"},we={class:"slidewrapContainer"},ke={class:"slidewrap"},De=["src","data-fallback"],Ie={class:"interact"},ye={class:"caption"},xe={class:"place"},be={class:"makerdrop"},Be={class:"LCS"},Ue={class:"LC"},Fe=["src"],Se=ue(()=>s("span",null,[s("img",{src:te,alt:"",class:"save"})],-1)),Pe=["src"],Te={class:"commentdetail"},Ye={class:"username"},Le={class:"content"},Me={class:"sub"},Re={class:"uploadtime"},He=["onClick"],Ne={class:"commentcontainer"},Ve={__name:"FeedDetail",setup(p){const C=$(),B=Z(),w=ee();g(()=>w.state.isModify),g(()=>C.params.Post_ID);const k=g(()=>w.state.User_ID),Y=u({}),t=u(null);u(null);const h=g(()=>t.value&&k.value===t.value.post.User_ID),L=async()=>{await n.post("/Direct/search_Room",{toUser_ID:Y.value.User_ID},{withCredentials:!0}).then(e=>{console.log(e.data);const{Room_ID:o}=e.data;B.push({name:"Room",params:{Room_ID:o}})}).catch(e=>{console.log(e)})},M=()=>{t.value.isFollowedByCurrentUser&&_.fire({title:"정말 팔로우를 취소하시겠습니까?",text:" ",icon:"warning",showCancelButton:!0,confirmButtonText:"팔로우 취소",cancelButtonText:"취소"}).then(async e=>{e.isConfirmed&&await n.post("/user/unfollow",{userId:t.value.post.User_ID},{withCredentials:!0}).then(o=>{console.log(o.data),_.fire("팔로우 취소","팔로우가 취소되었습니다.","success"),w.commit("Update_Follow_Status",!1)}).catch(o=>{console.log(o)})})},R=async()=>{_.fire({title:"정말로 게시글을 삭제하시겠습니까?",text:"삭제된 게시글은 되돌릴 수 없습니다.",icon:"warning",showCancelButton:!0,confirmButtonText:"삭제",cancelButtonText:"취소"}).then(async e=>{e.isConfirmed?await n.post("/feeds/Post_delete",{postId:t.value.post.Post_ID},{withCredentials:!0}).then(o=>{console.log(o.data),_.fire("게시글이 삭제되었습니다!","홈화면으로 이동합니다.","success"),t.value=null,B.push({name:"HomeFeed"})}).catch(o=>{console.log(o)}):e.dismiss===_.DismissReason.cancel&&_.fire("게시글 삭제가 취소되었습니다.","ㅋㅋ봐줌","error")})},v=u(""),D=u([]),I=()=>{n.post("/feeds/Comment/list",{Post_ID:t.value.post.Post_ID},{withCredentials:!0}).then(e=>{D.value=e.data,console.log(e.data)}).catch(e=>{console.log("오류발생"),console.log(e)})},U=()=>{b().format("YYYY년 MM월 DD일 HH:mm"),n.post("/feeds/Comment/add",{Post_ID:t.value.post.Post_ID,Comment:v.value},{withCredentials:!0}).then(e=>{console.log(e.data),I()}).catch(e=>{console.log("오류발생"),console.log(e)}),v.value=""},H=e=>{e.User_ID===k.value&&_.fire({title:"정말 코멘트를 지우겠습니까?",text:" ",icon:"warning",showCancelButton:!0,confirmButtonText:"코멘트 삭제",cancelButtonText:"취소"}).then(async o=>{o.isConfirmed&&n.post("/feeds/Comment/delete",{Comment_ID:e.Comment_ID},{withCredentials:!0}).then(r=>{console.log(r.data),I()}).catch(r=>{console.log("오류발생"),console.log(r)})})};u(null),j(()=>{console.log("테스트1"),console.log(C.params.Post_ID),n.get("/Feeds/Post_detail/"+C.params.Post_ID,{withCredentials:!0}).then(e=>{console.log(e.data),t.value=e.data,I()}).catch(e=>{console.log("오류발생"),console.log(e)})});const N=e=>{e.isLike?n.post("/feeds/Like/remove",{postId:e.Post_ID},{withCredentials:!0}).then(o=>{e.isLike=!e.isLike}).catch(o=>{o.response.status==400}):n.post("/feeds/Like/add",{postId:e.Post_ID},{withCredentials:!0}).then(o=>{e.isLike=!e.isLike}).catch(o=>{o.response.status==400})},V=e=>{e.target.src=e.target.getAttribute("data-fallback")},E=[oe,ae],f=u();return z(f,(e,o)=>{if(e!=o){const r={injectStyles:[`
        .mySwiper{
          width: 600px !important;
          height: auto !important;
          max-width: 1200px !important;
          margin: 0 auto !important;
          overflow: hidden !important;
          display: inline-block !important;
        }
      `]};Object.assign(f.value,r),f.value.initialize()}}),(e,o)=>{const r=q("router-link");return t.value?(i(),c("div",de,[s("div",_e,[s("div",me,[s("div",null,[s("span",pe,[F(r,{to:{name:"PersonalPage",params:{User_ID:t.value.post.User_ID}},class:"userID"},{default:x(()=>[G(l(t.value.post.User_ID),1)]),_:1},8,["to"])])]),s("div",he,[s("span",ve,l(d(b)(t.value.post.Post_Create_Timestamp).format("YYYY년 MM월 DD일 HH:mm")),1)])]),s("div",fe,[h.value?(i(),c("div",ge,[s("button",{class:"feeddelete",onClick:R},"삭제")])):m("",!0),h.value?m("",!0):(i(),c("div",Ce)),h.value?m("",!0):(i(),c("button",{key:2,class:"follow",onClick:M,style:A({backgroundColor:t.value.isFollowedByCurrentUser?"#EFEFEF":"black",borderColor:t.value.isFollowedByCurrentUser?"#F2F2F2":"black",color:t.value.isFollowedByCurrentUser?"black":"white"})},l(t.value.isFollowedByCurrentUser?"팔로잉":"팔로우"),5)),h.value?m("",!0):(i(),c("button",{key:3,class:"message",onClick:L}," 메시지 "))])]),s("div",we,[s("div",ke,[F(d(ne),{ref_key:"swiperRef",ref:f,init:"false",spaceBetween:1,slidesPerView:1,pagination:!0,navigation:!0,modules:E,class:"mySwiper"},{default:x(()=>[(i(!0),c(S,null,P(t.value.post.Image_Srcs,(a,y)=>(i(),J(d(le),{key:y},{default:x(()=>[s("img",{src:a,onError:V,"data-fallback":d(re),alt:"Image preview"},null,40,De)]),_:2},1024))),128))]),_:1},512)]),s("div",null,[s("div",Ie,[s("div",null,l(t.value.post.Post_Title),1),s("div",ye,l(t.value.post.Post_Caption),1)])])]),s("ul",xe,[s("li",null,l(t.value.tags),1)]),s("ul",be,[s("li",Be,[s("span",Ue,"좋아요 "+l(t.value.post.likeCount)+" 댓글 "+l(D.value.length),1),s("span",null,[s("img",{src:t.value.post.isLike?d(ie):d(se),alt:"",class:"like",onClick:o[0]||(o[0]=a=>N(t.value.post))},null,8,Fe)]),Se])]),(i(!0),c(S,null,P(D.value,(a,y)=>(i(),c("div",{key:y,class:"commentbox"},[s("span",null,[s("img",{src:a.Profile_Img,alt:"",class:"profile"},null,8,Pe)]),s("div",Te,[s("div",null,[s("span",Ye," @"+l(a.User_ID)+"-"+l(a.User_Name),1),s("span",Le,l(a.Comment_Text),1)]),s("div",Me,[s("span",Re,l(d(b)(a.Comment_Timestamp).format("YYYY년MM월DD일 HH:mm:ss")),1),T(s("span",{class:"reply",onClick:Ee=>H(a)},"삭제",8,He),[[Q,a.User_ID===k.value]])])])]))),128)),s("div",Ne,[T(s("input",{class:"comment",type:"text",placeholder:"댓글을 입력하세요.","onUpdate:modelValue":o[1]||(o[1]=a=>v.value=a),onKeypress:K(U,["enter"])},null,544),[[O,v.value]]),s("button",{class:"commenting",onClick:U},"입력")])])):m("",!0)}}},Ge=ce(Ve,[["__scopeId","data-v-3427d9c6"]]);export{Ge as default};
