import{c as w,r as o,A as P,o as V,B as j,e as n,f as l,F as L,l as U,w as z,m as J,n as Q,j as q,a as v,d as r,i as m,t as g,g as A,h as f,y as B,z as M,u as N,C as X,b as Y}from"./index-4ydSH2Vs.js";/* empty css                                                               */import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{l as E,s as x}from"./like-Cq13m2ZL.js";import{l as Z}from"./likeed-BS52KISc.js";const O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAaCAYAAACtv5zzAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsEAAA7BAbiRa+0AAAErSURBVEhL7ZahqoRQEIbHbaKIYLOJWAwWi8Vk2rTJKGLylcTqQxgERVSsJpsPsM+wqPecw2Evy66rXq7NDwbm/Gfm/+swMyJJEhiGAf4TVVXB8zyAvu9n9D6ksPflfr+j/hiw94X2h3EGrHIGrHIGrHIGrLIrQFEUUnvYHKBpGtR1TQr3W9kUoOs6tG0LsiyTwj3WtrAaYJomNE0DkiRRBUiPNcMwqLLM1wDLsqAsSxBFkSq/YK2qKjLzjcUAx3Egz3PgOI4q7wiCQGZs26bKOx8DrtcrpGkKLMtSZRk8k2UZ2flIURQvl4DruvPj8cDXzC7wzu12e/Ei3l3XPYUgCOZpmujKfsZxnH3ff/rhs4UcXnEcAzKGMAyBYRj093eQHURRBDzPo8PLgx/xnvjiJX+1UgAAAABJRU5ErkJggg==",$={class:"grid-container"},ee={class:"bodytop"},se={id:"result",class:"tagresult"},te=["onClick"],le={class:"tagbox"},ae=["src"],oe={class:"profile-container"},ie=["src"],ne=["src","onClick"],re=["src"],ce={__name:"HomeFeed",setup(ue){M();const h=N();w(()=>h.state.User_ID);const y=w(()=>h.state.isWrite);o(!1);const p=o(!1);o(null);const I=o(!1),a=o(null);o(E);const C=o(x),d=o([{Post_ID:1}]),T=()=>{const e=_.value.trim();e&&(c.value.push(e),_.value="")},R=e=>{c.value.splice(e,1)},_=o(""),c=o([]);P(y,()=>{v.get("/Feeds/Posts_list",{withCredentials:!0}).then(e=>{console.log(e),d.value=e.data,console.log(a.value),a.value&&(a.value.addEventListener("scroll",D),X(()=>{I.value||(a.value.scrollTop=a.value.scrollHeight,I.value=!0)}))}).catch(e=>{console.log("오류발생"),console.log(e)})},{immediate:!0});const S=()=>{h.commit("Switch_isWrite")},F=e=>{e.isLike?v.post("/feeds/Like/remove",{postId:e.Post_ID},{withCredentials:!0}).then(t=>{e.isLike=!e.isLike}).catch(t=>{t.response.status==400}):v.post("/feeds/Like/add",{postId:e.Post_ID},{withCredentials:!0}).then(t=>{e.isLike=!e.isLike}).catch(t=>{t.response.status==400})},H=()=>{p.value=!p.value,C.value=p.value?O:x},u=o([]),G=()=>{const e=c.value;e.length>0?u.value=d.value.filter(t=>e.some(i=>t.Post_Title.includes(i)||t.Post_Caption.includes(i))):u.value=d.value},b=async()=>{try{const e=await v.get("/Feeds/Posts_list",{withCredentials:!0});d.value=e.data,u.value=e.data}catch(e){console.error("오류 발생",e)}};P(c,G,{deep:!0}),b(),V(()=>{}),j(()=>{a.value&&a.value.removeEventListener("scroll",D)});function D(){const e=a.value.scrollTop,t=a.value.scrollHeight,i=a.value.clientHeight;console.log(e,i,t),e+i>=t&&(console.log("맨 아래 도달"),K())}function K(){console.log("Loading more messages...")}return(e,t)=>{const i=Y("router-link");return r(),n("div",$,[l("div",ee,[l("span",se,[(r(!0),n(L,null,U(c.value,(s,k)=>(r(),n("span",{key:k,class:"tag"},[m(g(s)+" ",1),l("button",{class:"deleteTagButton",onClick:de=>R(k)},"x",8,te)]))),128))]),l("span",le,[z(l("input",{class:"SearchTag",type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s),onKeyup:Q(T,["enter"]),placeholder:"관심있는 태그를 검색해보세요."},null,544),[[J,_.value]]),l("button",{onClick:t[1]||(t[1]=s=>S()),class:"writebutton"},"글쓰기")])]),u.value.length>0?(r(),n("div",{key:0,class:"feedSlider",ref_key:"FeedContainer",ref:a},[(r(!0),n(L,null,U(u.value,s=>(r(),n("div",{class:"grid-article",key:s.Post_ID},[A(i,{to:{name:"FeedDetail",params:{Post_ID:s.Post_ID}}},{default:f(()=>[l("img",{src:s.Image_Src,alt:"",class:"Eximage"},null,8,ae)]),_:2},1032,["to"]),l("ul",null,[l("li",oe,[l("img",{src:s.Profile_Img,alt:"",class:"profile"},null,8,ie),A(i,{to:{name:"PersonalPage",params:{User_ID:s.User_ID}},class:"userID"},{default:f(()=>[m(g(s.User_ID),1)]),_:2},1032,["to"]),l("img",{src:s.isLike?B(Z):B(E),alt:"",class:"like",onClick:k=>F(s)},null,8,ne),l("img",{src:C.value,alt:"",class:"save",onClick:H},null,8,re)]),l("li",null,[A(i,{to:{name:"FeedDetail",params:{Post_ID:s.Post_ID}},class:"title"},{default:f(()=>[m(g(s.Post_Title),1)]),_:2},1032,["to"])]),l("li",null,[A(i,{to:{name:"FeedDetail",params:{Post_ID:s.Post_ID}},class:"discription"},{default:f(()=>[m(g(s.Post_Caption),1)]),_:2},1032,["to"])])])]))),128))],512)):q("",!0)])}}},fe=W(ce,[["__scopeId","data-v-04d60cca"]]);export{fe as default};
