import{c as V,r as o,y as C,e as i,f as a,F as I,k as D,w as $,m as N,n as U,j as E,d as n,i as v,t as f,g,h as k,q as d,x as K,u as M,a as _,b as P}from"./index-DcFli-HX.js";import{l as W,a as S,s as w}from"./likeed-v1A9XkUo.js";import{s as j,m as q}from"./saveed-DRyjRmH-.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"grid-container"},z={class:"bodytop"},G={id:"result",class:"tagresult"},H=["onClick"],J={class:"tagbox"},O={key:0,class:"feedSlider",ref:"feedSliderContainer"},Q=["src"],X={class:"profile-container"},Y=["src"],Z=["src","onClick"],ee=["src","onClick"],se=["src","onClick"],te={__name:"PopularityTab",setup(ae){K();const h=M(),y=V(()=>h.state.isWrite),m=o([]),r=o([]);o(S),o(w);const p=o(""),c=o([]),L=()=>{const e=p.value.trim();e&&(c.value.push(e),p.value="")},T=e=>{c.value.splice(e,1)},x=()=>{const e=c.value;e.length>0?r.value=m.value.filter(s=>e.some(l=>s.Post_Title.includes(l)||s.Post_Caption.includes(l))):r.value=m.value};C(y,()=>{_.get("/Feeds/Popular",{withCredentials:!0}).then(e=>{m.value=e.data.map(s=>({...s,isLike:s.isLike??!1,isSave:s.isSave??!1})),r.value=m.value}).catch(e=>{console.log("오류발생"),console.log(e)})},{immediate:!0});const b=e=>{e.isLike?_.post("/feeds/Like/remove",{postId:e.Post_ID},{withCredentials:!0}).then(()=>{e.isLike=!e.isLike}).catch(s=>{s.response.status===400&&console.log("좋아요 취소 실패")}):_.post("/feeds/Like/add",{postId:e.Post_ID},{withCredentials:!0}).then(()=>{e.isLike=!e.isLike}).catch(s=>{s.response.status===400&&console.log("좋아요 실패")})},B=e=>{e.isSave?_.post("/feeds/Post_Store/delete",{postId:e.Post_ID},{withCredentials:!0}).then(()=>{e.isSave=!e.isSave}).catch(s=>{s.response.status===400&&console.log("저장 취소 실패")}):_.post("/feeds/Post_Store/add",{postId:e.Post_ID},{withCredentials:!0}).then(()=>{e.isSave=!e.isSave}).catch(s=>{s.response.status===400&&console.log("저장 실패")})},F=e=>{const{Post_ID:s}=e;h.commit("Switch_isPostDM",s),console.log("메시지 버튼 클릭")};return C(c,x,{deep:!0}),(e,s)=>{const l=P("router-link");return n(),i("div",R,[a("div",z,[a("span",G,[(n(!0),i(I,null,D(c.value,(t,u)=>(n(),i("span",{key:u,class:"tag"},[v(f(t)+" ",1),a("button",{class:"deleteTagButton",onClick:le=>T(u)},"x",8,H)]))),128))]),a("span",J,[$(a("input",{class:"SearchTag",type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>p.value=t),onKeyup:U(L,["enter"]),placeholder:"관심있는 태그를 검색해보세요."},null,544),[[N,p.value]]),a("button",{onClick:s[1]||(s[1]=t=>e.write_Button_Click()),class:"writebutton"}," 글쓰기 ")])]),r.value.length>0?(n(),i("div",O,[(n(!0),i(I,null,D(r.value,t=>(n(),i("div",{class:"grid-article",key:t.Post_ID},[g(l,{to:{name:"FeedDetail",params:{Post_ID:t.Post_ID}}},{default:k(()=>[a("img",{src:t.Image_Src,alt:"",class:"Eximage"},null,8,Q)]),_:2},1032,["to"]),a("ul",null,[a("li",X,[a("img",{src:t.Profile_Img,alt:"",class:"profile"},null,8,Y),g(l,{to:{name:"PersonalPage",params:{User_ID:t.User_ID}},class:"userID"},{default:k(()=>[v(f(t.User_ID),1)]),_:2},1032,["to"]),a("img",{src:t.isLike?d(W):d(S),alt:"like",class:"like",onClick:u=>b(t)},null,8,Z),a("img",{src:t.isSave?d(j):d(w),alt:"save",class:"save",onClick:u=>B(t)},null,8,ee),a("img",{src:d(q),alt:"message",class:"message",onClick:u=>F(t)},null,8,se)]),a("li",null,[g(l,{to:{name:"FeedDetail",params:{Post_ID:t.Post_ID}},class:"title"},{default:k(()=>[v(f(t.Post_Title),1)]),_:2},1032,["to"])]),a("li",null,[g(l,{to:{name:"FeedDetail",params:{Post_ID:t.Post_ID}},class:"description"},{default:k(()=>[v(f(t.Post_Caption),1)]),_:2},1032,["to"])])])]))),128))],512)):E("",!0)])}}},ce=A(te,[["__scopeId","data-v-aa476e51"]]);export{ce as default};
